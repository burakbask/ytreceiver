<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>YouTube Verileri</title>
  <!-- Google Font -->
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary: #ff0000;
      --bg: #121212;
      --card-bg: #1e1e1e;
      --text: #e0e0e0;
      --accent: #bb86fc;
      --transition: 0.3s;
    }
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: 'Roboto', sans-serif;
    }
    body {
      background: linear-gradient(135deg, #282828, #121212);
      color: var(--text);
      padding: 2rem;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    h2 {
      font-size: 2rem;
      margin-bottom: 1rem;
      color: var(--primary);
      text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
    }
    #receiver-container {
      width: 100%;
      max-width: 600px;
      background: var(--card-bg);
      border-radius: 12px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.5);
      overflow: hidden;
      transition: transform var(--transition);
    }
    #receiver-container:hover {
      transform: translateY(-5px);
    }
    #channel-info {
      padding: 1.5rem;
      border-bottom: 1px solid #333;
      animation: fadeIn var(--transition) ease-out;
    }
    #channel-info strong {
      color: var(--accent);
    }
    h3 {
      font-size: 1.25rem;
      margin: 1.5rem 1rem 0.5rem;
      color: var(--accent);
    }
    ul {
      list-style: none;
      padding: 0 1rem 1.5rem;
      animation: fadeIn var(--transition) ease-out;
    }
    li {
      margin: 0.75rem 0;
    }
    a {
      position: relative;
      color: var(--text);
      text-decoration: none;
      font-weight: 500;
      padding-bottom: 2px;
      transition: color var(--transition);
    }
    a::after {
      content: '';
      position: absolute;
      left: 0;
      bottom: 0;
      width: 100%;
      height: 2px;
      background: var(--primary);
      transform: scaleX(0);
      transform-origin: left;
      transition: transform var(--transition);
    }
    a:hover {
      color: var(--primary);
    }
    a:hover::after {
      transform: scaleX(1);
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
  </style>
</head>
<body>
  <h2>Kaydedilmiş YouTube Verileri</h2>
  <div id="receiver-container">
    <div id="channel-info">Gönderilen veri bekleniyor...</div>
    <h3>Abonelik Listesi</h3>
    <ul id="subscriptions-list"><li>Veri bekleniyor...</li></ul>
  </div>

  <script>
    window.opener?.postMessage(JSON.stringify({ status: 'ready' }), '*');

    window.addEventListener('message', ev => {
      if (ev.origin !== 'https://www.youtube.com' &&
          ev.origin !== 'https://ytreceiver.vercel.app') {
        console.warn('Bilinmeyen origin:', ev.origin);
        return;
      }

      let data;
      try { data = JSON.parse(ev.data); }
      catch { console.error('Mesaj JSON değil:', ev.data); return; }

      const ci = document.getElementById('channel-info');
      ci.innerHTML = `
        <strong>Channel ID:</strong> ${data.channelId}<br>
        <strong>Channel Name:</strong> ${data.channelName}<br>
        <strong>Channel Handle:</strong> ${data.channelHandle || 'Tespit edilemedi'}
      `;

      const ul = document.getElementById('subscriptions-list');
      if (!data.subs || data.subs.length === 0) {
        ul.innerHTML = '<li>Abonelik bulunamadı.</li>';
      } else {
        ul.innerHTML = data.subs
          .map(s => `<li><a href="${s.url}" target="_blank" rel="noopener">${s.title}</a></li>`)
          .join('');
      }
    }, false);
  </script>
</body>
</html>
